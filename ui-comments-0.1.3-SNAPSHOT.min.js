angular.module("ui.comments",["ui.comments.tpls","ui.comments.directive"]),angular.module("ui.comments.tpls",["template/comments/comment.html","template/comments/comments.html"]),angular.module("ui.comments.directive",[]).provider("commentsConfig",function(){function a(a,b){"string"==typeof b&&(d[a]=b)}function b(a,b){d[a]=b&&(angular.isString(b)&&b.length||angular.isFunction(b)||angular.isArray(b))?b:e}function c(a,b){"number"==typeof b&&(d[a]=b)}var d={containerTemplate:"template/comments/comments.html",commentTemplate:"template/comments/comment.html",orderBy:"best",commentController:void 0,depthLimit:5},e=function(){},f={containerTemplate:a,commentTemplate:a,orderBy:a,commentController:b,depthLimit:c};this.$get=function(){return d},this.set=function(a,b){var c,d,e,g;if("string"==typeof a)c=f[a],c&&c(a,b);else if("object"==typeof a)for(e=Object.keys(a),g=0;g<e.length;++g)d=e[g],c=f[d],c&&c(d,a[d])}}).directive("comments",["$compile","$interpolate","commentsConfig",function(a,b,c){return{restrict:"EA",require:"?^comment",transclude:!0,replace:!0,templateUrl:function(){return c.containerTemplate},scope:{comments:"=commentData"},controller:function(){},link:{pre:function(a,d,e,f){var g=d.controller("comments"),h=f?f.comments:null;if(h)g.commentsDepth=h.commentsDepth+1,g.commentsRoot=h.commentsRoot,g.commentsParent=h;else{g.commentsDepth=1,g.commentsRoot=null;var i=angular.isDefined(e.commentDepthLimit)?e.commentDepthLimit:c.depthLimit;"string"==typeof i&&(i=b(i,!1)(a.$parent),"string"==typeof i&&(i=parseInt(i,10))),("number"!=typeof i||i!==i)&&(i=0),g.commentsDepthLimit=i}a.commentsDepth=g.commentsDepth,e.$observe("orderBy",function(b){a.commentOrder=b||c.orderBy})}}}}]).directive("comment",["$compile","commentsConfig","$controller","$exceptionHandler","$timeout",function(a,b,c,d){return{require:["^comments","comment"],restrict:"EA",transclude:!0,replace:!0,templateUrl:function(){return b.commentTemplate},scope:{comment:"=commentData"},controller:["$scope",function(){}],link:function(e,f,g,h){function i(a,b,c){if(k){var e,f,g=a.$$listeners[b]||[],h=[c];for(e=0,f=g.length;f>e;e++)if(g[e])try{g[e].apply(null,h)}catch(i){d(i)}else g.splice(e,1),e--,f--}}function j(a){if(angular.isArray(a)||(a=[]),a.length>0&&!q){if(l.commentsDepth>=(l.commentsRoot||l).commentsDepthLimit)return void i(e,"$depthLimitComments",e.comment);o=r(e,function(a){m.commentsTransclude?(p=m.commentsTransclude.clone(!0),m.commentsTransclude.replaceWith(a)):f.append(a)}),q=!0,i(e,"$filledNestedComments",o)}else!a.length&&q&&(q=!1,m.commentsTransclude&&p?o.replaceWith(p):o.remove(),i(e,"$emptiedNestedComments",m.commentsTransclude||f),p=o=void 0)}var k,l=h[0],m=h[1],n=b.commentController;e.commentDepth=l.commentsDepth,e.commentDepthLimit=(l.commentsRoot||l).commentsDepthLimit,m.comments=l,n&&(k=c(n,{$scope:e,$element:f}),k&&f.data("$CommentController",k)),"true"===f.parent().attr("child-comments")&&f.addClass("child-comment");var o,p,q=!1,r=a('<div comments child-comments="true" comment-data="comment.children"></div>');e.$watch("comment",function(){j(e.comment.children)},!0)}}}]).directive("commentsTransclude",function(){return{restrict:"EA",require:"^comment",link:function(a,b,c,d){c.$addClass("comments-transclude"),d.commentsTransclude=b}}}),angular.module("template/comments/comment.html",[]).run(["$templateCache",function(a){a.put("template/comments/comment.html",'<div class="comment">\n  <div class="comment-header">\n    <span class="comment-user">\n      <a class="comment-username" ng-if="comment.profileUrl" ng-href="{{comment.profileUrl}}" title="{{comment.name}}">{{comment.name}}</a>\n      <img class="comment-avatar" ng-if="comment.avatarUrl" ng-src="{{comment.avatarUrl}}" alt="{{comment.name}}" />\n      <span class="comment-username" ng-if="!comment.profileUrl">{{comment.name}}</span>\n      <span class="comment-date" ng-if="comment.date">{{comment.date}}</span>\n  </div>\n  <div class="comment-body">\n    <div ng-bind="comment.text"></div>\n    <div comments-transclude comment-data="comment.children"></div>\n  </div>\n</div>')}]),angular.module("template/comments/comments.html",[]).run(["$templateCache",function(a){a.put("template/comments/comments.html",'<div class="comments">\n  <comment ng-repeat="comment in comments" comment-data="comment"></comment>\n</div>\n')}]);